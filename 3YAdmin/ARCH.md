# 功能架构 -- 2018-10-25

## UI页面布局概述

* 整个页面首先分为左右两部分,左侧占一小部分，右侧占一大部分；
    * 左侧分为上下两部分，上部分占一小部分，下侧占一大部分;
        * 上部分显示应用logo和应用名称文字
        * 下部分是系统当前模块的功能导航菜单栏
    * 左侧分从上至下依次为
        * 头部区 (包括 系统模块导航，全屏切换按钮，用户中心图标)
        * 面包屑区
        * 主工作区(各个功能页面的展示区)

## 实体和关系

* 页面 (`page`)
    * 开发人员开发的一个某种功能的页面
    * 页面会展示到主工作区
    * 开发人员为每个页面其分配一个系统全局的访问路径`url`
    * 别名 : 资源页面
    * 面向开发人员 : 每个功能页面对应由一个 `React Component` 实现
    * 系统开发完成后开发人员要公开页面和对应的访问`url`给运营人员用于定义菜单

* 菜单 (`menu`)
    * 每个菜单对应一个功能页面
    * 运营人员可以通过菜单管理页面创建菜单并创建它们的树形层级结构
        * 菜单分页顶层菜单和子菜单
        * 顶层菜单也称为系统模块 (显示在页面系统模块导航区域)
        * 每个顶层菜单对应一棵菜单树,逻辑上对树高没有限制

> **问题**:菜单概念被抽象出来的根本目的是什么 ？ 用于 RBAC ？ 还是用于UI展示 ？ 如果不是处于这些目的，似乎可以不需要此概念。

* 功能 (`function`)
    * 系统管理中的实体概念，用于表示系统能提供的功能
    * 每个功能对应某一个菜单的某个功能点，也可以叫做操作，比如列表查看，删除，编辑，新增等
    * 一个功能有一个功能显示名称，和一个功能编码
    * 功能定义本身不涉及数据，只是是否对某个菜单模块能否执行某个操作，严格来讲，功能定义还是数据无关的
    * 功能编码必须全局唯一，页面代码或者服务端控制器方法会使用此代码定义访问自己需要的功能代码
    * 功能沒有有层次结构，而是一个功能列表
    * 系统提供给运营人员功能管理页面用于功能的增删改查

* 用户 (`user`)
    * 其实这里每个用户指的使用该管理端的管理员(类工作人员)，而不是系统的客户(消费买商品或者服务的人)账号

> **问题** : 运营人员动态增加的功能怎样才能被之前写完的页面或者控制器代码用起来，似乎不可能啊，严重质疑此处！！！

* 角色 (`role`)
    * 运营人员可以创建角色，制定一个名称，比如物业经理

* 角色权限 (`role's permissions`)
    * 运营人员可以管理角色都能访问什么功能，也就是对角色进行授权
    * 角色权限其实是每个角色和若干个功能的关联关系


* 角色用户 (`role's users`)
    * 运营人员可以管理角色可以授予哪些用户，
    * 角色用户其实是以角色为主题，看角色和若干个用户的关联关系

* 用户角色 (`user's roles`)
    * 运营人员可以管理用户可以扮演哪些角色
    * 用户角色其实是以用户为主题，看用户和若干个角色的关联关系

> **问题**: 如果界面上针对某个数据实体的操作当前用户无权访问，那么相应的操作按钮要不要显示，本例子似乎没有解决此问题


## Web应用界面权限控制检查点清单

这里所说的Web应用界面包含两类界面，一类是UI界面，一类是 Web API界面(这类界面也可以叫做服务端控制器方法界面)。为什么
说有这两类界面，原因很简单：这两类界面都对外暴露。

UI界面，自然不用说了，它通过浏览器暴露给用户用于和系统进行交互，这种暴露一般也是我们UI界面存在的目的。而另外一种界面，
Web API界面就是我们不得不暴露出来的，它被动地暴露在网络中，原本的目的是为了浏览器Web界面访问服务端数据使用，但实际上，
本系统用户有可能通过输入URL的方式试图直接访问一些当前用户不应该访问到的数据，另外还有一些潜伏在网络某处的恶意访问者
发起一些恶意的请求。对于这种请求，我们也是要做相应的权限检查。


